# NovelViewerについて

## 本プロジェクトの目的

Web小説ビューアの作成

## 技術的観点

* Flutter を用いて構築
* 当面はPCツールとして作成するが、将来はiPad, Androidなどのタブレットへの対応を視野に入れる

## 機能

### テキストダウンロード機能

* なろう、カクヨムなどのWeb小説サイトからのダウンロードに対応
* ダウンロード結果はローカルフォルダにWebページ単位でテキストファイルとして保存
* ダウンロードについては https://github.com/endo5501/DownloadNovel または /Users/endo5501/Work/DownloadNovel を参照(Pythonにより実装されたテキストサイトからの小説ダウンローダ)
* ダウンロードテキストファイルには必ず先頭に番号を付与する

### ダウンロードテキストの保存・管理

* ダウンロードされたテキストは小説のタイトルごとにローカルのディレクトリに保存して管理
* 直接ディレクトリに配置しても自動で認識
* 保存されたテキストファイルはディレクトリ単位で左辺カラムに表示

### ノベルビューア

* 選択したテキストを表示
* ルビ表示などの限定的なHTMLタグは認識

### 選択した単語の検索・LLMを使用した要約

* 選択した単語を検索し、右辺カラムに結果を表示
* LLM設定が行われていた場合、その要約結果を表示する
  * LLMによる要約結果はタブで"ネタバレあり","ネタバレなし"に分けて表示する
  * "ネタバレあり"タブには、そのドキュメントフォルダ内のテキストを全検索し、その検索結果近傍のテキストを用いて要約を行う
  * "ネタバレなし"タブには、その検索開始単語までの検索結果までの情報を使用して、要約を行う(例:001,0002,...100,までファイルがあった時、検索実行時の位置が040のファイルだった時、001〜040の検索開始位置までの検索結果を元に要約を作成する)
* 右辺カラムは2段に分かれており、上段にLLMの要約情報、下段に検索結果が表示される
* LLMの要約はネタバレあり・ネタバレなしの画面で[解析開始]ボタンを押すと解析が実行される
* 用語を検索・要約する処理やプロンプトについては https://github.com/endo5501/GenGlossary または /Users/endo5501/Work/GenGlossary を参照(登録したテキストファイル群の用語集を作成するPythonツール)

### 縦書き表示対応

* 通常のテキスト表示は横書きで表示されるが、縦書き表示にも対応すること

### ブックマーク機能

* どこまで読んだかを管理するブックマーク機能を追加する

### 表示フォントの切り替え

* 設定画面にて変更可能

## レイアウト

* 3カラム表示が基本
  * 左辺カラムにはダウンロード/登録したファイルを管理するファイル一覧、ブックマーク一覧を表示。タブ切り替え
  * 中央カラムには左辺カラムで選択したファイルの内容を表示
  * 右辺カラムには中央カラムで選択&検索した結果、LLM要約情報を表示
* 設定画面
  * 画面中に表示される設定画面アイコンを押すことで表示
  * 利用LLMの設定画面。LLMにはOllama,OpenAI互換APIに対応
  * 縦書き/横書き選択
  * 表示フォント選択
  * ダークモード切り替え
