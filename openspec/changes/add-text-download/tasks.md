## 1. プロジェクトセットアップ

- [x] 1.1 `http` パッケージを pubspec.yaml に追加
- [x] 1.2 `html` パッケージ（dart HTML parser）を pubspec.yaml に追加
- [x] 1.3 `lib/features/text_download/` ディレクトリ構造を作成（data/sites/, providers/, presentation/）

## 2. サイトパーサー共通インターフェース

- [x] 2.1 `NovelSite` 抽象クラスを実装（canHandle, fetchIndex, fetchEpisode）
- [x] 2.2 `NovelIndex` データクラスを実装（novelTitle, episodes リスト）
- [x] 2.3 `Episode` データクラスを実装（index, title, url）
- [x] 2.4 URL ホスト名から適切なパーサーを選択するファクトリロジックを実装

## 3. なろうサイトパーサー

- [x] 3.1 なろうインデックスページの HTML 解析を実装（タイトル抽出、エピソード URL リスト取得）
- [x] 3.2 なろうエピソードページの HTML 解析を実装（本文テキスト抽出、ルビタグ保持）
- [x] 3.3 なろう URL の正規化処理を実装
- [x] 3.4 なろうパーサーのユニットテストを作成

## 4. カクヨムサイトパーサー

- [x] 4.1 カクヨムインデックスページの HTML 解析を実装（タイトル抽出、エピソード URL リスト取得）
- [x] 4.2 カクヨムエピソードページの HTML 解析を実装（本文テキスト抽出、ルビタグ保持）
- [x] 4.3 カクヨム URL の正規化処理を実装
- [x] 4.4 カクヨムパーサーのユニットテストを作成

## 5. ダウンロードサービス

- [x] 5.1 HTTP クライアントのラッパーを実装（User-Agent 設定、リクエスト間隔制御 0.7 秒）
- [x] 5.2 ファイル名サニタイズ処理を実装（不正文字の置換）
- [x] 5.3 エピソードのテキストファイル保存処理を実装（ゼロ埋め番号 + タイトル命名規則）
- [x] 5.4 小説ディレクトリ作成処理を実装
- [x] 5.5 全エピソード一括ダウンロード処理を実装（進捗コールバック付き、エラー時スキップ継続）
- [x] 5.6 ダウンロードサービスのユニットテストを作成

## 6. 状態管理（Riverpod providers）

- [x] 6.1 ダウンロード状態（idle, downloading, completed, error）を管理する provider を実装
- [x] 6.2 ダウンロード進捗（現在/合計エピソード数）を管理する provider を実装

## 7. ダウンロードダイアログ UI

- [x] 7.1 ダウンロードダイアログの基本レイアウトを実装（URL 入力、出力先選択、ダウンロードボタン）
- [x] 7.2 URL バリデーション表示を実装（サポートサイト判定、エラーメッセージ）
- [x] 7.3 出力先ディレクトリ選択機能を実装（デフォルトは file browser の現在ディレクトリ）
- [x] 7.4 ダウンロード進捗表示を実装（N/M エピソード完了）
- [x] 7.5 ダウンロード完了・エラー表示を実装

## 8. AppBar・ファイルブラウザ連携

- [x] 8.1 AppBar にダウンロードボタンを追加
- [x] 8.2 ダウンロード完了後のファイルブラウザ自動リフレッシュを実装（directoryContentsProvider invalidate）
- [x] 8.3 ダウンロード先が現在のディレクトリと異なる場合の自動遷移を実装

## 9. 結合テスト

- [x] 9.1 ダウンロードダイアログの Widget テストを作成
- [x] 9.2 URL バリデーションのテストを作成
- [x] 9.3 ファイル命名規則のテストを作成
- [x] 9.4 ファイルブラウザ自動リフレッシュのテストを作成
