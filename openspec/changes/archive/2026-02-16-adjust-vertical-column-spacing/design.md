## Context

縦書きモードの列間隔は `_kRunSpacing = 2.0` として `vertical_text_page.dart` と `vertical_text_viewer.dart` の両方にハードコードされている。Wrapウィジェットのセンチネルにより実効ギャップは `2 * runSpacing` となるため、現在は4pxのギャップとなっている。

既存の設定パターン（SharedPreferences + Riverpod Notifier + SettingsDialog）が確立されており、フォントサイズの設定がスライダーUIで実装済み。同じパターンで列間隔設定を追加する。

## Goals / Non-Goals

**Goals:**
- 縦書きモードのデフォルト列間隔を広げて読みやすくする
- 設定画面から列間隔をスライダーで調整可能にする
- 設定値を永続化し、アプリ再起動後も維持する
- ページネーション計算に設定値を反映する

**Non-Goals:**
- 横書きモードの行間隔調整（今回のスコープ外）
- テキスト高さ（`_kTextHeight`）の設定化
- 列間隔のプリセット（「狭い」「標準」「広い」）の提供

## Decisions

### 1. 設定値の単位: runSpacing値を直接保存

設定値として `runSpacing` の値（Wrapウィジェットに渡す値）をそのまま保存する。

**理由**: 実効ギャップ（`2 * runSpacing`）を保存してから内部で割る方式は、計算の二重変換が生じる。コード内で直接使用される値を保存する方がシンプルで、ページネーションの計算でもそのまま使える。

**代替案**: 実効ギャップ（ユーザーが見る実際のピクセル数）を保存する方式。UXは直感的だが、内部でrunSpacingへの変換が毎回必要になり、ページネーション計算でも変換が入る。

### 2. デフォルト値と範囲

- デフォルト: `8.0`（実効ギャップ16px）
- 最小値: `0.0`（実効ギャップ0px）
- 最大値: `24.0`（実効ギャップ48px）
- スライダーのステップ: `1.0`刻み（divisions = 24）

**理由**: 現在の2.0（実効4px）が狭すぎるとのフィードバック。8.0（実効16px）は一般的な縦書き書籍の列間に近い。最大24.0は十分広い余白を確保でき、それ以上は実用的でない。

### 3. ウィジェットへのパラメータ渡し

`VerticalTextViewer` と `VerticalTextPage` に `columnSpacing` パラメータを追加する。

```
TextViewerPanel → VerticalTextViewer(columnSpacing: ...) → VerticalTextPage(columnSpacing: ...)
```

**理由**: 既存の `baseStyle` パラメータと同様に、上位ウィジェットから明示的に渡すパターン。Riverpodプロバイダーを各ウィジェット内で直接watchするとウィジェットのテスタビリティが下がるため、パラメータ注入を採用。

### 4. Riverpodプロバイダーのパターン

`FontSizeNotifier` と同じパターンを採用。`previewColumnSpacing()` でリアルタイムプレビュー、`persistColumnSpacing()` でスライダー操作終了時に永続化。

**理由**: フォントサイズのスライダーと同じUXを統一的に提供する。スライダー操作中の毎フレーム永続化を避けつつ、リアルタイムプレビューを実現。

### 5. UI配置

設定ダイアログで「フォントサイズ」スライダーの下に「列間隔」スライダーを配置。縦書きモードが無効でもスライダーは表示する（横書きモードでは効果なしだが、設定の存在を認知させる）。

**理由**: 非表示にするとユーザーが設定の存在に気づかない可能性がある。フォント関連設定と同じセクションに並べることで直感的。

## Risks / Trade-offs

- **既存ユーザーへの影響**: デフォルト値が2.0→8.0に変わるため、既存ユーザーの表示レイアウトが変わる（ページあたりの列数が減少）。→ 許容範囲。設定で元の値に戻せる。
- **テストへの影響**: 既存テストでハードコードされた`_kRunSpacing`を参照している箇所がある。→ テストではデフォルト値またはパラメータで明示的に指定するよう更新。
- **ページネーション精度**: 列間隔が大きくなるとページあたりの列数が減り、ページ数が増える。→ 既存のページネーション計算ロジックは`_kRunSpacing`をそのまま使うため、パラメータ化するだけで対応可能。
